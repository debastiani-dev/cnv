{% extends 'layouts/base_dashboard.html' %}
{% load i18n static %}

{% block content %}
<div class="px-4 sm:px-6 lg:px-8">
    
    <!-- Breadcrumb / Back Navigation -->
    <div class="mb-8">
        <a href="{% url 'authentication:user-list' %}" class="text-sm font-medium text-gray-500 hover:text-gray-700 flex items-center">
            <svg class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z" clip-rule="evenodd" />
            </svg>
            {% trans "Back to Users" %}
        </a>
    </div>

    <div class="overflow-hidden rounded-lg bg-white shadow ring-1 ring-black ring-opacity-5">
        <!-- Header / Banner -->
        <div class="h-32 bg-indigo-600"></div>
        
        <div class="px-4 pb-6 sm:px-6">
            <!-- Profile Info Wrapper -->
            <div class="grid grid-cols-1 sm:grid-cols-[auto_1fr] gap-x-8 items-end">
                <!-- Container 1: Image -->
                <div class="flex -mt-16 sm:-mt-24 z-10 sm:block justify-center sm:justify-start p-2">
                    {% if target_user.profile_image %}
                        <img class="h-24 w-24 rounded-full ring-4 ring-white sm:h-32 sm:w-32 object-cover bg-white" style="max-width: 8rem; max-height: 8rem;" src="{{ target_user.profile_image.url }}" alt="{{ target_user.username }}">
                    {% else %}
                        <img class="h-24 w-24 rounded-full ring-4 ring-white sm:h-32 sm:w-32 object-cover bg-white" style="max-width: 8rem; max-height: 8rem;" src="{% static 'img/default_profile.png' %}" alt="Default Profile">
                    {% endif %}
                </div>
                
                <!-- Container 2: Name & Details -->
                <div class="min-w-0 flex-1 pb-1 sm:pb-2 text-center sm:text-left pt-2 sm:pt-0">
                     <h1 class="truncate text-2xl font-bold text-gray-900">{{ target_user.get_full_name|default:target_user.username }}</h1>
                     <p class="text-sm font-medium text-gray-500">@{{ target_user.username }}</p>
                </div>
            </div>

        <!-- Details Grid -->
        <dl class="mt-6">
            <div class="border-t border-gray-100 bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                <dt class="text-sm font-medium text-gray-500">{% trans "Email Address" %}</dt>
                <dd class="mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0">{{ target_user.email }}</dd>
            </div>
            <div class="border-t border-gray-100 bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                <dt class="text-sm font-medium text-gray-500">{% trans "Role" %}</dt>
                <dd class="mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0">
                    {% if target_user.is_superuser %}
                         <span class="inline-flex items-center rounded-md bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700 ring-1 ring-inset ring-purple-700/10">Admin</span>
                    {% elif target_user.is_staff %}
                         <span class="inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10">Staff</span>
                    {% else %}
                         <span class="inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10">User</span>
                    {% endif %}
                </dd>
            </div>
            <div class="border-t border-gray-100 bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                <dt class="text-sm font-medium text-gray-500">{% trans "Account Status" %}</dt>
                <dd class="mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0">
                    {% if target_user.is_active %}
                        <span class="inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20">{% trans "Active" %}</span>
                    {% else %}
                        <span class="inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10">{% trans "Inactive" %}</span>
                    {% endif %}
                </dd>
            </div>
            <div class="border-t border-gray-100 bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                <dt class="text-sm font-medium text-gray-500">{% trans "Date Joined" %}</dt>
                <dd class="mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0">{{ target_user.date_joined|date:"F j, Y" }}</dd>
            </div>
            <div class="border-t border-gray-100 bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                <dt class="text-sm font-medium text-gray-500">{% trans "Last Login" %}</dt>
                <dd class="mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0">{{ target_user.last_login|date:"F j, Y H:i"|default:"Never" }}</dd>
            </div>
        </dl>
        
        <!-- Footer / Action Buttons -->
        <div class="border-t border-gray-200 bg-gray-50 px-4 py-4 sm:px-6 flex justify-end space-x-4">
             <a href="{% url 'authentication:user-update' target_user.pk %}" class="inline-flex justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
                <svg class="-ml-0.5 mr-1.5 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z" />
                    <path d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z" />
                </svg>
                {% trans "Edit Profile" %}
            </a>
            <a href="{% url 'authentication:user-delete' target_user.pk %}" class="inline-flex justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500">
                {% trans "Delete User" %}
            </a>
        </div>
    </div>
</div>
{% endblock %}
